# GIIP 后台管理界面使用指南

## 概述

已为 GIIP 系统实现了完整的后台管理界面，管理员和编辑可以通过该界面管理内容和用户。

## 功能特性

### 1. 自动跳转
- 管理员（admin）或编辑（editor）登录后自动跳转到后台管理界面
- 普通用户（user）登录后停留在前台页面

### 2. 仪表板
- 显示系统统计数据：
  - 新闻总数
  - 活动总数
  - 会议总数
  - 用户总数
- 快速操作按钮，可快速跳转到各个管理模块

### 3. 新闻管理
- 查看所有新闻列表
- 编辑新闻（即将推出）
- 删除新闻
- 添加新闻（即将推出）

### 4. 活动管理
- 查看所有活动列表
- 编辑活动（即将推出）
- 删除活动
- 添加活动（即将推出）

### 5. 会议管理
- 查看所有会议列表
- 编辑会议（即将推出）
- 删除会议
- 添加会议（即将推出）

### 6. 用户管理（仅管理员）
- 查看所有用户列表
- 修改用户角色（admin/editor/user）
- 查看用户注册时间

## 访问方式

### 方式一：登录后自动跳转
1. 使用管理员或编辑账号登录
2. 系统自动跳转到 `/admin.html`

### 方式二：直接访问
1. 在浏览器中访问：`http://localhost/admin.html`（Docker）或 `http://localhost:8080/admin.html`（本地开发）
2. 如果未登录，系统会自动跳转到首页

### 方式三：通过用户菜单
1. 登录后，在页面右上角的用户菜单中
2. 点击"后台管理"链接

## 测试账号

使用以下账号测试后台管理功能：

### 管理员账号
- 邮箱：`admin@giip.info`
- 密码：`admin123`
- 权限：完整的管理权限，包括用户管理

### 编辑账号
- 邮箱：`editor@giip.info`
- 密码：`editor123`
- 权限：内容管理权限（新闻、活动、会议）

### 普通用户账号
- 邮箱：`user@giip.info`
- 密码：`user123`
- 权限：无后台访问权限

## 权限说明

### Admin（管理员）
- ✅ 查看仪表板
- ✅ 管理新闻
- ✅ 管理活动
- ✅ 管理会议
- ✅ 管理用户
- ✅ 修改用户角色

### Editor（编辑）
- ✅ 查看仪表板
- ✅ 管理新闻
- ✅ 管理活动
- ✅ 管理会议
- ❌ 管理用户
- ❌ 修改用户角色

### User（普通用户）
- ❌ 无后台访问权限

## 技术实现

### 文件结构
```
frontend/
├── admin.html          # 后台管理界面 HTML
├── js/
│   ├── admin.js        # 后台管理逻辑
│   ├── auth.js         # 认证模块（已更新）
│   └── api-client.js   # API 客户端（已添加 AdminAPI）
└── css/
    └── auth.css        # 认证和用户菜单样式
```

### 主要功能

#### 1. 权限检查
```javascript
// 在 admin.js 中自动检查用户权限
if (this.user.role !== 'admin' && this.user.role !== 'editor') {
    alert('您没有访问后台管理系统的权限');
    window.location.href = '/index.html';
    return;
}
```

#### 2. 自动跳转
```javascript
// 在 auth.js 中登录成功后自动跳转
if (this.user.role === 'admin' || this.user.role === 'editor') {
    window.location.href = '/admin.html';
}
```

#### 3. API 集成
```javascript
// AdminAPI 提供用户管理功能
const AdminAPI = {
    async getUsers() { ... },
    async updateUserRole(userId, role) { ... }
};
```

## 使用流程

### 1. 启动系统
```bash
# 使用 Docker
docker-compose up -d

# 或本地开发
cd backend && npm start
cd frontend && python -m http.server 8080
```

### 2. 登录管理员账号
1. 访问 `http://localhost`
2. 点击右上角"Login"按钮
3. 输入管理员邮箱：`admin@giip.info`
4. 输入密码：`admin123`
5. 点击"Login"

### 3. 自动跳转到后台
- 登录成功后，系统自动跳转到后台管理界面
- 显示仪表板和统计数据

### 4. 管理内容
- 点击左侧菜单切换不同的管理模块
- 使用表格中的操作按钮进行编辑或删除

### 5. 管理用户（仅管理员）
- 点击"用户管理"
- 查看所有用户列表
- 点击"修改角色"按钮更改用户权限

## 响应式设计

后台管理界面支持响应式设计：

- **桌面端**：侧边栏固定显示
- **移动端**：侧边栏可折叠，通过汉堡菜单切换

## 安全特性

1. **JWT 认证**：所有 API 请求自动携带 JWT token
2. **权限验证**：前端和后端双重权限检查
3. **自动跳转**：未授权用户自动跳转到首页
4. **XSS 防护**：所有用户输入都经过转义处理

## 后续开发计划

### 即将推出的功能
1. ✅ 删除功能（已实现）
2. 🔄 添加/编辑表单（开发中）
3. 🔄 批量操作
4. 🔄 搜索和筛选
5. 🔄 分页功能
6. 🔄 数据导出

### 增强功能
1. 富文本编辑器
2. 图片上传
3. 数据统计图表
4. 操作日志
5. 权限细粒度控制

## 故障排除

### 问题：无法访问后台
**解决方案**：
1. 确认已使用管理员或编辑账号登录
2. 检查浏览器控制台是否有错误
3. 确认 token 已正确保存在 localStorage

### 问题：数据加载失败
**解决方案**：
1. 确认后端服务正常运行
2. 检查 API 端点是否正确
3. 查看浏览器网络请求是否成功

### 问题：删除操作失败
**解决方案**：
1. 确认用户有相应权限
2. 检查后端日志
3. 确认数据库连接正常

## 相关文档

- [认证指南](./AUTHENTICATION_GUIDE.md)
- [API 文档](./API_DOCUMENTATION.md)
- [快速开始](./QUICK_START.md)
- [Docker 指南](./DOCKER_GUIDE.md)

## 支持

如有问题，请查看：
1. 浏览器控制台错误信息
2. 后端日志：`docker-compose logs api`
3. 数据库日志：`docker-compose logs db`
